package publish.subscribe.string;

import json.messages.SelectedStateMessage;

public class Client implements ClientInterface {
	
	private SenderInterface sender;
	private double[] possibleStates;
	private double selectedState;
	
	public Client() {
		// TODO Auto-generated constructor stub
		sender = new Sender();
		possibleStates = new double[4];
		possibleStates[0] = 1;
		possibleStates[1] = 2;
		possibleStates[2] = 3;
		possibleStates[3] = 4;
		selectedState = 2;
	}
	
	@Override
	public void start() {
		// TODO Auto-generated method stub
		this.sendPossibleStates();
		this.sendSelectedState();
	}

	@Override
	public void setPossibleStates(double[] possibleStates) {
		this.possibleStates = possibleStates;		
	}

	@Override
	public void setSelectedStates(double selectedState) {
		this.selectedState = selectedState;
	}

	@Override
	public void sendPossibleStates() {
		// TODO convert possibleStates into Json format and then send it
		// Now we send just some string
		String json = "ExamplePossibleStates";
		String stringMessage = json;
		String serverIP = TestConstants.serverIP;  	// Test
		String port = TestConstants.port;			// Test
		try {
			this.sender.send(stringMessage, serverIP, port);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	@Override
	public void sendSelectedState() {
		// TODO convert possibleStates into Json format and then send it
		// Now we send just some string
		// Basic information
		SelectedStateMessage selStMsg = 
				new SelectedStateMessage(
						"ExampleSourceIP",
						"ExampleDestIP",
						"ExampleSourceID",
						"ExampleDestID"	);
		// Selected state
		String json = selStMsg.toJson(this.selectedState);
		String stringMessage = json;
		String serverIP = TestConstants.serverIP;  	// Test
		String port = TestConstants.port;			// Test
		try {
			this.sender.send(stringMessage, serverIP, port);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	public static void main(String[] args){
		Client client = new Client();
		client.start();
	}
}
